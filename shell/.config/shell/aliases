# Unified shell aliases (sourced by both bash and zsh)
# Requires PLATFORM variable from .profile

# ------------------------------------------------------------------------------
# Navigation
# ------------------------------------------------------------------------------

alias ..='cd ..'
alias ...='cd ../..'
alias ....='cd ../../..'
alias cdd='cd - 1>/dev/null'

# ------------------------------------------------------------------------------
# Git
# ------------------------------------------------------------------------------

alias g='git'
# Enable git completions for the 'g' alias in bash
if [[ -n "$BASH_VERSION" ]] && type _git &>/dev/null; then
  complete -o default -o nospace -F _git g
fi
alias gaa='git add --all'
alias gb='git branch'
alias gba='git branch -a'
alias gc='git commit --verbose'
alias gca='git commit --verbose --all'
alias gco='git checkout'
alias gd='git diff'
alias gdm='git diff main'
alias ge='vi .git/config'
alias gg='git log --graph --all'
alias ggf='git log --graph --all --pretty=fuller --decorate'
alias gl='git pull'
alias gp='git push'
alias gs='git status'

# ------------------------------------------------------------------------------
# General
# ------------------------------------------------------------------------------

alias c='opencode'
alias d='docker'
alias r='rails'
alias ta='tmux attach'
alias tl='tmux ls'
alias www='python3 -m http.server 8000'
n() { if [ "$#" -eq 0 ]; then nvim .; else nvim "$@"; fi; }

# fzf file picker with bat preview
if command -v fzf &>/dev/null && command -v bat &>/dev/null; then
  alias e='vim $(fzf -m --preview "bat --color=always --style=numbers {}")'
fi

# ------------------------------------------------------------------------------
# ls / eza
# ------------------------------------------------------------------------------

# Use eza for ls with icons if available
if command -v eza &>/dev/null; then
  alias ls='eza -lh --group-directories-first --icons=auto'
  alias l='ls'
  alias lsa='ls -a'
  alias lt='eza --tree --level=2 --long --icons --git'
  alias lta='lt -a'
else
  alias l='ls -Ahl'
  if [[ "$PLATFORM" == 'Darwin' ]]; then
    alias ls='ls -FG'
  else
    alias ls='ls -F --color=auto'
  fi
fi

# ------------------------------------------------------------------------------
# macOS-specific
# ------------------------------------------------------------------------------

if [[ "$PLATFORM" == 'Darwin' ]]; then
  alias dsunhook="find . -name '.DS_Store' -exec rm -rf {} \;"
  alias tu='top -o cpu'
  alias tm='top -o vsize'
fi
